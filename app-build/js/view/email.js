define("email",["underscore","backbone","jquery","handlebars","model","view"],function(e,r,o,i,T){var u=null,v=r.View.extend({el:o("#contContainer"),initialize:function(){this.render()},events:{"click .formEmail button":"sendMail"},render:function(){u=layer.toDataURL({mimeType:"image/jpeg",quality:.9});o.post("save.php",{data:u},function(){});var e={total:o("#total").text(),iva:o("#iva").text(),totalIVA:o("#totalIVA").text()};this.$el.attr("class","init").css({overflow:"auto"});var r={carrito:carrito.toJSON(),viasCarrito:viasCarrito.toJSON(),image:u,soporte:soporteProducto.toJSON(),precio:e},T=o("#emailTemplate").html(),v=i.compile(T),b=v(r);this.$el.html(b);o("#contContainer").css({display:"block"})},historyBack:function(e){e.preventDefault()},sendMail:function(e){var r=o("#emailForm");validar_formulario(r,e)&&o.ajax({url:url+"email.php",type:"POST",data:r.serialize()+"&datos="+o(".listEmail").html()+"&image="+u,success:function(e){var r=jQuery.parseJSON(e);if(r.status){popupModel=new T.Popup;popupModel.set("message",r.mensaje);new vPopup}}});e.preventDefault()},close:function(){this.undelegateEvents()}});return v});