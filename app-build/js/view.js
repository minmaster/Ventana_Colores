define("view",["underscore","backbone","collection","model","soporteData"],function(e,t,n,r,i){var s=t.View.extend({el:$("#soportesContainer"),model:r.Soporte,initialize:function(){this.render()},events:{"click .elem":"navigateApp"},render:function(){var e=$("#soportesTemplate").html(),t=Handlebars.compile(e),n=t(soportes.toJSON());this.$el.html(n),animation_intro(),$(".dibujo").each(function(){var e=$(this).attr("id");drawObjetoInit(e)})},navigateApp:function(e){var t=$(e.currentTarget).index(),n=soportes.at(t),r=n.get("con_vias");localStorage.idSoporte=n.get("id"),localStorage.vias=0,r?(popup_content("Seleccione la cantidad de vÃ­as"),viewVias=new o):appRouter.navigate("app",!0)},close:function(){this.undelegateEvents()}}),o=t.View.extend({el:$("#viasContainer"),model:r.Via,initialize:function(){this.render()},events:{"click .subelem":"navigateAppVias","click .opacity":"closePopup"},render:function(){var e=$("#viasTemplate").html(),t=Handlebars.compile(e),n=t(vias.toJSON());this.$el.html(n)},navigateAppVias:function(e){var t=$(e.currentTarget).attr("id");localStorage.vias=t,appRouter.navigate("app",!0)},closePopup:function(e){alert("hola")},close:function(){this.undelegateEvents()}}),u=t.View.extend({el:$("#objetosContainer"),model:r.Objeto,initialize:function(){this.close(),this.render()},events:{"mouseenter .symbol":"mouseOverSymbol","mouseout .symbol":"mouseOutSymbol","click .categorias li":"clickCategorias"},render:function(){var e={categorias:categorias.toJSON(),diseniosGenerales:objetos.listbyCategory("1").toJSON(),diseniosInfantiles:objetos.listbyCategory("2").toJSON()},t=$("#objetosTemplate").html(),n=Handlebars.compile(t),r=n(e);this.$el.html(r),$(".categorias li:first").addClass("activo"),$(".ajax-disenios-generales").elastislide({minItems:2})},mouseOverSymbol:function(e){var t=$(e.currentTarget),n=t.offset().left,r=t.offset().top,i=t.find(".titulo").text(),s=t.find(".descripcion").text(),o=t.find(".precio").text(),u=t.attr("id"),a=t.attr("mwidth"),f=t.attr("mheight");$(".popup-vinilo").css({top:r-30,left:n}),$(".popup-vinilo .descripcion").html(s+" "+o+" euros"),$(".popup-vinilo .titulo").html(i),$(".popup-vinilo").show(),t.css("cursor","hand");var l=new Kinetic.Stage({container:"objeto",width:a*5,height:f*2});$(".popup-vinilo").css({"margin-top":"-"+$(".popup-vinilo").height()+"px","min-width":a*5});var c=new Kinetic.Layer,h=new Kinetic.Shape({drawFunc:function(e){var t=e.getContext();t=drawSymbol(u,t),e.fillStroke(this)},fill:"#000000"});h.setScale(config.scaleObjetos),c.add(h),l.add(c)},mouseOutSymbol:function(e){var t=$(e.currentTarget);$(".popup-vinilo").removeAttr("style"),$(".popup-vinilo #objeto").empty(),t.find(".popup-vinilo").remove()},clickCategorias:function(e){var t=$(e.currentTarget),n=t.index()+1;$(".categorias li").removeClass("activo"),t.addClass("activo"),$(".slide-objetos .tab").addClass("nodisplay"),$(".slide-objetos .tab:nth-child("+n+")").removeClass("nodisplay"),n==2&&($(".elastislide-wrapper").length>2||($(".ajax-disenios-infantiles").removeAttr("style"),$(".ajax-disenios-infantiles").elastislide({minItems:2})))},close:function(){this.undelegateEvents()}}),a=t.View.extend({el:$("#tejidosContainer"),model:r.Tejido,initialize:function(){this.render()},events:{"click .tejidoEvent":"actualizarTejido","click .lupa":"lupaDisabled","mouseenter .lupa":"lupaOn","mouseleave .lupa":"lupaOff"},render:function(){var e=$("#tejidosTemplate").html(),t=Handlebars.compile(e),n=t(tejidos.toJSON());this.$el.html(n),$(".pagination").pajinate({items_per_page:6})},actualizarTejido:function(e){var t=$(e.currentTarget),n=t.attr("id"),r=t.attr("name");$.ajax({url:url+"selectTejido.json",type:"POST",data:{idtejido:n},success:function(e){var t=jQuery.parseJSON(e);if(localStorage["vias"]==0){$("#tejido").text(r),$(".pd .tejido").text(r),$("#tejidoId").val(n),$(".popup-tejidos").fadeOut("300");var i=$("#colores-soporte").html(),s=Handlebars.compile(i),o=s(t.colores);$(".colores-soporte").html(o),$(".paleta-colores li span").each(function(){var e=$(this).html();$(this).css({background:"#"+e})}),soporteProducto.set({tejidoId:n,tejidoNombre:r}),dragColoresSoportes(),getPrecioSoporte()}else{var u=parseInt($(".viasList li.active").text())-1,a=viasCarrito.at(u);a.set({tejidoId:n,tejidoNombre:r}),getPrecioVia(u);var i=$("#viasColoresTemplate").html(),s=Handlebars.compile(i),o=s(t.colores);$("#coloresViasContainer").html(o),$(".coloresList li span").each(function(){var e=$(this).html();$(this).css({background:"#"+e})}),$(".coloresList li span").on("click",function(e){var t=$(this).attr("title"),n=$(this).html();a.set({color:t});var r=triangleCopy.getChildren()[u];r.setFill("#"+n),layer.draw(),$(".viasList li.active").css({background:"#"+n}),$(".viasList li").removeClass("active"),$(".tejidosList").addClass("opacityTe"),$("#coloresViasContainer").empty()})}}})},lupaOn:function(e){var t=$(e.currentTarget),n=t.attr("href");t.after("<div class='popupImage'><img src='"+n+"' /></div>")},lupaOff:function(e){var t=$(e.currentTarget);$(".popupImage").length&&t.next().remove()},lupaDisabled:function(e){e.preventDefault()},close:function(){this.undelegateEvents()}}),f=t.View.extend({el:$("#list-vinilos-comprados"),initialize:function(){this.render()},render:function(){var e=carrito.at(carrito.length-1),t=$("#carritoTemplate").html(),n=Handlebars.compile(t),r=n(e.toJSON());this.$el.append(r)},close:function(){this.undelegateEvents()}});return{ViewSoporte:s,ViewVias:o,ViewObjetos:u,ViewTejidos:a,ViewCarrito:f}});