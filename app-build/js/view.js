define("view",["underscore","backbone","collection","model","soporteData"],function(e,r,o,i){var T=r.View.extend({el:$("#soportesContainer"),model:i.Soporte,initialize:function(){this.render()},events:{"click .elem":"navigateApp"},render:function(){var e=$("#soportesTemplate").html(),r=Handlebars.compile(e),o=r(soportes.toJSON());this.$el.html(o);animation_intro();$(".dibujo").each(function(){var e=$(this).attr("id");drawObjetoInit(e)})},navigateApp:function(e){var r=$(e.currentTarget).index(),o=soportes.at(r),i=o.get("con_vias");localStorage.idSoporte=o.get("id");localStorage.vias=0;if(i){popup_content("Seleccione la cantidad de vÃ­as");viewVias=new u}else appRouter.navigate("app",!0)},close:function(){this.undelegateEvents()}}),u=r.View.extend({el:$("#viasContainer"),model:i.Via,initialize:function(){this.render()},events:{"click .subelem":"navigateAppVias","click .opacity":"closePopup"},render:function(){var e=$("#viasTemplate").html(),r=Handlebars.compile(e),o=r(vias.toJSON());this.$el.html(o)},navigateAppVias:function(e){var r=$(e.currentTarget).attr("id");localStorage.vias=r;appRouter.navigate("app",!0)},closePopup:function(){alert("hola")},close:function(){this.undelegateEvents()}}),v=r.View.extend({el:$("#objetosContainer"),model:i.Objeto,initialize:function(){this.close();this.render()},events:{"mouseenter .symbol":"mouseOverSymbol","mouseout .symbol":"mouseOutSymbol","click .categorias li":"clickCategorias"},render:function(){var e={categorias:categorias.toJSON(),diseniosGenerales:objetos.listbyCategory("1").toJSON(),diseniosInfantiles:objetos.listbyCategory("2").toJSON()},r=$("#objetosTemplate").html(),o=Handlebars.compile(r),i=o(e);this.$el.html(i);$(".categorias li:first").addClass("activo");$(".ajax-disenios-generales").elastislide({minItems:2})},mouseOverSymbol:function(e){var r=$(e.currentTarget),o=r.offset().left,i=r.offset().top,T=r.find(".titulo").text(),u=r.find(".descripcion").text(),v=r.find(".precio").text(),b=r.attr("id"),C=r.attr("mwidth"),z=r.attr("mheight");$(".popup-vinilo").css({top:i-30,left:o});$(".popup-vinilo .descripcion").html(u+" "+v+" euros");$(".popup-vinilo .titulo").html(T);$(".popup-vinilo").show();r.css("cursor","hand");var n=new Kinetic.Stage({container:"objeto",width:5*C,height:2*z});$(".popup-vinilo").css({"margin-top":"-"+$(".popup-vinilo").height()+"px","min-width":5*C});var t=new Kinetic.Layer,l=new Kinetic.Shape({drawFunc:function(e){var r=e.getContext();r=drawSymbol(b,r);e.fillStroke(this)},fill:"#000000"});l.setScale(config.scaleObjetos);t.add(l);n.add(t)},mouseOutSymbol:function(e){var r=$(e.currentTarget);$(".popup-vinilo").removeAttr("style");$(".popup-vinilo #objeto").empty();r.find(".popup-vinilo").remove()},clickCategorias:function(e){var r=$(e.currentTarget),o=r.index()+1;$(".categorias li").removeClass("activo");r.addClass("activo");$(".slide-objetos .tab").addClass("nodisplay");$(".slide-objetos .tab:nth-child("+o+")").removeClass("nodisplay");if(2==o)if($(".elastislide-wrapper").length>2);else{$(".ajax-disenios-infantiles").removeAttr("style");$(".ajax-disenios-infantiles").elastislide({minItems:2})}},close:function(){this.undelegateEvents()}}),b=r.View.extend({el:$("#tejidosContainer"),model:i.Tejido,initialize:function(){this.render()},events:{"click .tejidoEvent":"actualizarTejido","click .lupa":"lupaDisabled","mouseenter .lupa":"lupaOn","mouseleave .lupa":"lupaOff"},render:function(){var e=$("#tejidosTemplate").html(),r=Handlebars.compile(e),o=r(tejidos.toJSON());this.$el.html(o);$(".pagination").pajinate({items_per_page:6})},actualizarTejido:function(e){var r=$(e.currentTarget),o=r.attr("id"),i=r.attr("name");$.ajax({url:url+"selectTejido.json",type:"POST",data:{idtejido:o},success:function(e){var r=jQuery.parseJSON(e);if(0==localStorage.vias){$("#tejido").text(i);$(".pd .tejido").text(i);$("#tejidoId").val(o);$(".popup-tejidos").fadeOut("300");var T=$("#colores-soporte").html(),u=Handlebars.compile(T),v=u(r.colores);$(".colores-soporte").html(v);$(".paleta-colores li span").each(function(){var e=$(this).html();$(this).css({background:"#"+e})});soporteProducto.set({tejidoId:o,tejidoNombre:i});dragColoresSoportes();getPrecioSoporte()}else{var b=parseInt($(".viasList li.active").text())-1,C=viasCarrito.at(b);C.set({tejidoId:o,tejidoNombre:i});getPrecioVia(b);var T=$("#viasColoresTemplate").html(),u=Handlebars.compile(T),v=u(r.colores);$("#coloresViasContainer").html(v);$(".coloresList li span").each(function(){var e=$(this).html();$(this).css({background:"#"+e})});$(".coloresList li span").on("click",function(){var e=$(this).attr("title"),r=$(this).html();C.set({color:e});var o=triangleCopy.getChildren()[b];o.setFill("#"+r);layer.draw();$(".viasList li.active").css({background:"#"+r});$(".viasList li").removeClass("active");$(".tejidosList").addClass("opacityTe");$("#coloresViasContainer").empty()})}}})},lupaOn:function(e){var r=$(e.currentTarget),o=r.attr("href");r.after("<div class='popupImage'><img src='"+o+"' /></div>")},lupaOff:function(e){var r=$(e.currentTarget);$(".popupImage").length&&r.next().remove()},lupaDisabled:function(e){e.preventDefault()},close:function(){this.undelegateEvents()}}),C=r.View.extend({el:$("#list-vinilos-comprados"),initialize:function(){this.render()},render:function(){var e=carrito.at(carrito.length-1),r=$("#carritoTemplate").html(),o=Handlebars.compile(r),i=o(e.toJSON());this.$el.append(i)},close:function(){this.undelegateEvents()}});return{ViewSoporte:T,ViewVias:u,ViewObjetos:v,ViewTejidos:b,ViewCarrito:C}});