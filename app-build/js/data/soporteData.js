define("soporteData",["jquery","model","collection","view","dragdrop","soporteCarrito","viasCarrito","viasTejidos"],function(e,r,o,T,i,v,b,u){return{getSoporteData:function(C){sessionStorage.sessionSecurity&&(sessionSecurity=sessionStorage.sessionSecurity);config=6==localStorage.idSoporte?{scaleObjetos:.05}:{scaleObjetos:.07};e.ajax({url:url+"selectSoporte.json",type:"POST",data:{idsoporte:C,securitySession:sessionSecurity},success:function(z){var l=jQuery.parseJSON(z);objetos=new o.Objetos;categorias=new o.Categorias;tejidos=new o.Tejidos;e("#medidas").empty();e("#escenario").empty();e("#soportesContainer").empty();e("#list-vinilos-comprados").empty();e(l.disenios[2]).each(function(e,r){objetos.add([{nombre:r.titulo,id:r.idDisenio,imagen:r.imagen,medidaVariable:r.tamanioVariable,categoria:r.idCategoria,ancho:r.ancho,alto:r.alto,descripcion:r.descripcion,greca:r.greca,precio:r.pvp,variosColores:r.variosColores,colores:r.numeroColores}])});e(l.disenios[1]).each(function(e,r){objetos.add([{nombre:r.titulo,id:r.idDisenio,imagen:r.imagen,medidaVariable:r.tamanioVariable,categoria:r.idCategoria,ancho:r.ancho,alto:r.alto,descripcion:r.descripcion,greca:r.greca,precio:r.pvp,variosColores:r.variosColores,colores:r.numeroColores}])});e(l.categorias).each(function(e,r){categorias.add([{nombre:r.nombreCategoria,id:r.idCategoria}])});e(l.tejidos).each(function(e,r){tejidos.add([{nombre:r.descripcion,id:r.idTejido,imagen:r.imagen,precio:r.precioMedio}])});viewObjetos&&viewObjetos.close();viewTejidos&&viewTejidos.close();viewObjetos=new T.ViewObjetos;viewTejidos=new T.ViewTejidos;8==l.soporte.idSoporte||e(".popup-tejidos").fadeIn("300");e(".txt-nombre").text(l.soporte.nombre);e("input#productoId").val(l.soporte.idSoporte);if("6"!=localStorage.idSoporte){e('input[name="anchoDefault"]').val(l.soporte.anchoPorDefecto);e("input#anchoMaximo").val(l.soporte.anchoMax);e("input#anchoMinimo").val(l.soporte.anchoMin)}else{e('input[name="anchoDefault"]').val(l.soporte.anchoPorDefecto*localStorage.vias);e("input#anchoMaximo").val(l.soporte.anchoMax*localStorage.vias);e("input#anchoMinimo").val(l.soporte.anchoMin*localStorage.vias)}e('input[name="altoDefault"]').val(l.soporte.altoPorDefecto);e("input#altoMinimo").val(l.soporte.altoMin);e("input#altoMaximo").val(l.soporte.altoMax);e("#tejido").text(l.tejidoPorDefecto.descripcion);e("#tejidoId").val(l.tejidoPorDefecto.idTejido);drawObjeto(e("input#productoId").val());drawSoporteMedidas(e("input#productoId").val());8==l.soporte.idSoporte&&e("#tejido").css({display:"none"});if(1==l.soporte.dimensionesFijas){var n=e("#selectmedidas").html(),t=Handlebars.compile(n),a=t(l.medidas);e(".selectmedidas").html(a)}else{e(".medida_colcha").addClass("nodisplay");e(".medida_estandar").removeClass("nodisplay");if("6"!=localStorage.idSoporte){e('.medida_estandar input[name="ancho"]').val(l.soporte.anchoPorDefecto);e('.medida_estandar input[name="alto"]').val(l.soporte.altoPorDefecto)}else{e('.medida_estandar input[name="ancho"]').val(l.soporte.anchoPorDefecto*localStorage.vias);e('.medida_estandar input[name="alto"]').val(l.soporte.altoPorDefecto)}s&&e(".spinnerAncho").spinner("destroy");var s=e(".spinnerAncho").spinner({step:1,numberFormat:"n",min:e("#anchoMinimo").val(),max:e("#anchoMaximo").val(),spin:function(r,o){if(6!=localStorage.idSoporte){soporteProducto.set({ancho:o.value});getPrecioSoporte(o.value,e('.medida_estandar input[name="alto"]').val());calcular_medida(o.value,e('.medida_estandar input[name="alto"]').val())}else{for(var T=o.value/localStorage.vias,i=0;localStorage.vias>i;i++){var v=viasCarrito.at(i);v.set({ancho:T});getPrecioVia(i)}calcular_medida(T,e('.medida_estandar input[name="alto"]').val());soporteProducto.set({ancho:o.value})}}});e('.medida_estandar input[name="ancho"]').change(function(){if(/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(e(this).val())){var r=parseInt(e("#anchoMinimo").val()),o=parseInt(e("#anchoMaximo").val()),T=e(this).val();if(T>=r&&o>=T)redimensionar("ancho",e(this).val());else if(T>o){e(this).val(o);redimensionar("ancho",e(this).val())}else if(r>T){e(this).val(r);redimensionar("ancho",e(this).val())}}else alert("Este campo solo admite datos númericos")});e('.medida_estandar input[name="alto"]').change(function(){if(/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(e(this).val())){var r=parseInt(e("#altoMinimo").val()),o=parseInt(e("#altoMaximo").val()),T=e(this).val();if(T>=r&&o>=T)redimensionar("alto",e(this).val());else if(T>o){e(this).val(o);redimensionar("alto",e(this).val())}else if(r>T){e(this).val(r);redimensionar("alto",e(this).val())}}else alert("Este campo solo admite datos númericos")});uiSpinnerAlto&&e(".spinnerAlto").spinner("destroy");uiSpinnerAlto=e(".spinnerAlto").spinner({step:1,numberFormat:"n",min:e("#altoMnimo").val(),max:e("#altoMaximo").val(),spin:function(r,o){if(6!=localStorage.idSoporte){soporteProducto.set({alto:o.value});getPrecioSoporte(e('.medida_estandar input[name="ancho"]').val(),o.value);calcular_medida(e('.medida_estandar input[name="ancho"]').val(),o.value)}else{for(var T=e('.medida_estandar input[name="ancho"]').val()/localStorage.vias,i=0;localStorage.vias>i;i++){var v=viasCarrito.at(i);v.set({alto:o.value});getPrecioVia(i)}calcular_medida(T,e('.medida_estandar input[name="alto"]').val());soporteProducto.set({alto:o.value})}}})}if(localStorage.vias>0)var h=!0;else var h=!1;soporteProducto=new r.SoporteProducto({producto:l.soporte.nombre,id:C,unidades:1,ancho:l.soporte.anchoPorDefecto,alto:l.soporte.altoPorDefecto,con_vias:h,vias:localStorage.vias,tejidoId:l.tejidoPorDefecto.idTejido,tejidoNombre:l.tejidoPorDefecto.descripcion});6==localStorage.idSoporte&&soporteProducto.set({ancho:l.soporte.anchoPorDefecto*localStorage.vias});viasCarrito=new o.ViaCarrito;for(var c=1;localStorage.vias>=c;c++)viasCarrito.add([{via:c,tejidoId:l.tejidoPorDefecto.idTejido,tejidoNombre:l.tejidoPorDefecto.descripcion,ancho:l.soporte.anchoPorDefecto,alto:l.soporte.altoPorDefecto,color:""}]);getPrecioSoporte();new v;new b;localStorage.vias>0&&new u;var n=e("#colores-disenios").html(),t=Handlebars.compile(n),a=t(l.colores_disenios);e(".colores-disenios").html(a);if("6"!=localStorage.idSoporte){var n=e("#colores-soporte").html(),t=Handlebars.compile(n),a=t(l.coloresSoporteDefecto);e(".colores-soporte").html(a)}else e("#coloresSoportes").hide();e(".paleta-colores li span").each(function(){var r=e(this).html();e(this).css({background:"#"+r})});slideContent(".colores-disenios");dragColoresSoportes();i.dragdrop();e(".divLoader").fadeOut("fast")}})}}});